{% extends "admin/base.html" %}

{% block admin_content %}
<div id="categories-app">
    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
        <h2 style="margin: 0; color: #303133;">åˆ†ç±»ç®¡ç†</h2>
        <a href="/admin/categories/create" style="padding: 8px 16px; background: #409eff; color: white; text-decoration: none; border-radius: 4px;">
            + æ–°å»ºåˆ†ç±»
        </a>
    </div>

    <!-- åˆ†ç±»åˆ—è¡¨ -->
    <div style="background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden;">
        <table style="width: 100%; border-collapse: collapse;">
            <thead style="background: #f5f7fa;">
                <tr>
                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ebeef5;">åˆ†ç±»åç§°</th>
                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ebeef5;">æè¿°</th>
                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ebeef5;">æ–‡ç« æ•°é‡</th>
                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ebeef5;">åˆ›å»ºæ—¶é—´</th>
                    <th style="padding: 12px; text-align: left; border-bottom: 1px solid #ebeef5; width: 200px;">æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {% for category in categories %}
                <tr style="border-bottom: 1px solid #ebeef5;">
                    <td style="padding: 12px;">
                        <div style="font-weight: 500; color: #303133;">{{ category.name }}</div>
                    </td>
                    <td style="padding: 12px; color: #606266; font-size: 14px;">
                        {{ category.description or '-' }}
                    </td>
                    <td style="padding: 12px; color: #606266;">
                        {{ category.post_count or 0 }}
                    </td>
                    <td style="padding: 12px; color: #606266; font-size: 13px;">
                        {{ category.created_at.strftime('%Y-%m-%d %H:%M') if category.created_at else '' }}
                    </td>
                    <td style="padding: 12px;">
                        <a href="/admin/categories/{{ category.id }}/edit" style="padding: 5px 10px; background: #409eff; color: white; text-decoration: none; border-radius: 4px; margin-right: 5px; display: inline-block;">
                            ç¼–è¾‘
                        </a>
                        <button onclick="deleteCategory({{ category.id }}, '{{ category.name }}')" style="padding: 5px 10px; background: #f56c6c; color: white; border: none; border-radius: 4px; cursor: pointer;">
                            åˆ é™¤
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>

        {% if not categories %}
        <div style="text-align: center; padding: 60px;">
            <div style="font-size: 64px; color: #c0c4cc; margin-bottom: 20px;">ğŸ“</div>
            <h3 style="margin: 0 0 10px 0; color: #303133;">æš‚æ— åˆ†ç±»</h3>
            <p style="margin: 0 0 20px 0; color: #909399;">è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•åˆ†ç±»</p>
            <a href="/admin/categories/create" style="padding: 8px 16px; background: #409eff; color: white; text-decoration: none; border-radius: 4px;">
                åˆ›å»ºç¬¬ä¸€ä¸ªåˆ†ç±»
            </a>
        </div>
        {% endif %}
    </div>
</div>

<script>
// åˆ é™¤åˆ†ç±»
function deleteCategory(categoryId, categoryName) {
    if (confirm('ç¡®å®šè¦åˆ é™¤åˆ†ç±» "' + categoryName + '" å—ï¼Ÿ\n\næ³¨æ„ï¼šåˆ é™¤åˆ†ç±»ä¸ä¼šåˆ é™¤ç›¸å…³æ–‡ç« ï¼Œä½†æ–‡ç« å°†å¤±å»åˆ†ç±»å½’å±ã€‚')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = '/admin/categories/' + categoryId + '/delete';
        document.body.appendChild(form);
        form.submit();
    }
}
</script>
{% endblock %}
